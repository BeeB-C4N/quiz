<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ちょっこし珠洲クイズ！</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=M+PLUS+Rounded+1c:wght@400;800&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'M PLUS Rounded 1c', sans-serif;
        }
        .gradient-text {
            background-clip: text;
            -webkit-background-clip: text;
            color: transparent;
        }
        .bg-art-gradient {
            background-image: linear-gradient(135deg, #0f172a 0%, #1e3a8a 50%, #ea580c 100%);
        }
        .bg-choice-a {
             background-image: linear-gradient(to right, #2563eb, #3b82f6);
        }
        .bg-choice-b {
             background-image: linear-gradient(to right, #ec4899, #f472b6);
        }
        .card-bg {
            background-color: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        /* アニメーション */
        .fade-in {
            animation: fadeIn 0.7s cubic-bezier(0.250, 0.460, 0.450, 0.940) both;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes bounce-in {
            0% { transform: scale(0.5) rotate(-10deg); opacity: 0; }
            60% { transform: scale(1.1) rotate(5deg); opacity: 1; }
            100% { transform: scale(1) rotate(0deg); }
        }
        .animate-bounce-in {
            animation: bounce-in 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55) both;
        }
    </style>
</head>
<body class="bg-slate-900 bg-art-gradient text-gray-800">

    <div id="app" class="container mx-auto max-w-2xl p-4 min-h-screen flex flex-col justify-center items-center">

        <!-- トップページ -->
        <div id="top-page" class="text-center p-8 card-bg rounded-2xl shadow-2xl fade-in w-full">
            <h1 class="text-4xl md:text-5xl font-extrabold gradient-text bg-gradient-to-r from-blue-600 to-orange-500 mb-4">ちょっこし珠洲クイズ！</h1>
            <p class="text-gray-600 mb-8">能登半島のさいはて、珠洲市の魅力をクイズで発見しよう！<br>全５問の２択クイズに挑戦して、あなたも珠洲マスターに！</p>
            <button id="start-button" class="w-full md:w-auto bg-gradient-to-r from-orange-500 to-rose-500 hover:from-orange-600 hover:to-rose-600 text-white font-bold py-4 px-12 rounded-full text-lg shadow-xl transition-transform transform hover:scale-105">
                クイズを始める！
            </button>
        </div>

        <!-- クイズページ -->
        <div id="quiz-page" class="hidden p-4 sm:p-8 card-bg rounded-2xl shadow-2xl w-full">
            <div id="quiz-header" class="text-center mb-4">
                <h2 class="text-3xl font-extrabold gradient-text bg-gradient-to-r from-blue-600 to-cyan-400">第<span id="question-number">1</span>問</h2>
            </div>
            <div id="question-image-container" class="mb-6">
                <img id="question-image" src="" alt="問題画像" class="w-full h-auto object-cover rounded-lg shadow-lg border-2 border-white aspect-video">
            </div>
            <div id="choices-container" class="grid grid-cols-1 gap-4">
                <button class="choice-button w-full bg-choice-a hover:opacity-90 text-white font-bold py-4 px-6 rounded-lg text-lg shadow-md transition-all transform hover:scale-105" data-choice="0"></button>
                <button class="choice-button w-full bg-choice-b hover:opacity-90 text-white font-bold py-4 px-6 rounded-lg text-lg shadow-md transition-all transform hover:scale-105" data-choice="1"></button>
            </div>
            
            <!-- 解説エリア -->
            <div id="answer-container" class="hidden mt-6 pt-6 border-t-2 border-slate-200">
                <img id="answer-image" src="" alt="答え画像" class="w-full h-auto object-cover rounded-lg shadow-lg mb-4 border-2 border-white aspect-video">
                <div class="p-4 bg-slate-100 rounded-lg">
                    <p id="explanation" class="text-gray-700"></p>
                </div>
                <button id="next-button" class="mt-6 w-full bg-gradient-to-r from-cyan-500 to-blue-500 hover:from-cyan-600 hover:to-blue-600 text-white font-bold py-3 px-6 rounded-full text-lg shadow-md transition-transform transform hover:scale-105">
                    次の問題へ
                </button>
            </div>
        </div>

        <!-- アンケートページ -->
        <div id="survey-page" class="hidden text-center p-4 sm:p-8 card-bg rounded-2xl shadow-2xl w-full">
            <h2 class="text-3xl font-extrabold gradient-text bg-gradient-to-r from-purple-600 to-pink-500 mb-4">ご協力のお願い</h2>
            <p class="text-gray-600 mb-6">今後の珠洲市観光PRの参考のため、簡単なアンケートにご協力いただけませんか？</p>
            <div class="aspect-w-16 aspect-h-9 mb-6 rounded-lg overflow-hidden border-2 border-white">
                <iframe src="https://forms.gle/QzWXz5p5AyC44bqBA" width="100%" height="400" frameborder="0" marginheight="0" marginwidth="0">読み込んでいます…</iframe>
            </div>
            <button id="skip-survey-button" class="w-full bg-gray-500 hover:bg-gray-600 text-white font-bold py-3 px-6 rounded-full text-lg shadow-md transition-transform transform hover:scale-105">
                スキップして結果を見る
            </button>
        </div>


        <!-- 結果ページ -->
        <div id="result-page" class="hidden text-center p-4 sm:p-8 card-bg rounded-2xl shadow-2xl w-full">
            <h2 class="text-4xl font-extrabold gradient-text bg-gradient-to-r from-orange-500 to-rose-500 mb-4">結果発表！</h2>
            <p class="text-xl mb-2">あなたの正解数は...</p>
            <p class="text-7xl font-extrabold my-4"><span id="score" class="gradient-text bg-gradient-to-br from-yellow-400 to-red-500">0</span> / 5 問</p>
            <p id="result-message" class="text-lg font-semibold mb-8 text-slate-700"></p>
            
            <a id="share-button" href="" target="_blank" class="inline-block w-full mb-6 bg-black hover:bg-gray-800 text-white font-bold py-3 px-6 rounded-full text-lg shadow-md transition-transform transform hover:scale-105">
                Xで結果をシェアする
            </a>

            <div class="mt-8 text-left">
                <h3 class="text-xl font-bold text-slate-800 mb-4 border-b-2 border-orange-400 pb-2">もっと珠洲を知ろう！</h3>
                <ul class="space-y-3">
                    <li><a href="https://www.city.suzu.lg.jp/" class="text-blue-600 hover:text-orange-500 transition">珠洲市HP</a></li>
                    <li><a href="https://sutto-zutto.com/" class="text-blue-600 hover:text-orange-500 transition">珠洲市移住サイト〈すっとずっと〉</a></li>
                    <li><a href="https://oku-noto.jp/ja/index.html" class="text-blue-600 hover:text-orange-500 transition">奥能登芸術祭サイト</a></li>
                </ul>
            </div>
             <button id="retry-button" class="mt-8 w-full bg-gradient-to-r from-orange-500 to-rose-500 hover:from-orange-600 hover:to-rose-600 text-white font-bold py-3 px-6 rounded-full text-lg shadow-xl transition-transform transform hover:scale-105">
                もう一度挑戦する
            </button>
        </div>
    </div>
    
    <!-- 正解・不正解フィードバックモーダル -->
    <div id="feedback-modal" class="hidden fixed inset-0 bg-slate-900 bg-opacity-70 flex items-center justify-center z-50 p-4">
        <div id="feedback-modal-content" class="text-7xl sm:text-9xl font-extrabold text-white" style="text-shadow: 0 0 20px rgba(0,0,0,0.5);">
            <!-- JSで内容をセット -->
        </div>
    </div>


    <script>
        // DOM要素の取得
        const topPage = document.getElementById('top-page');
        const quizPage = document.getElementById('quiz-page');
        const surveyPage = document.getElementById('survey-page');
        const resultPage = document.getElementById('result-page');
        const startButton = document.getElementById('start-button');
        const questionNumber = document.getElementById('question-number');
        const questionImage = document.getElementById('question-image');
        const choicesContainer = document.getElementById('choices-container');
        const choiceButtons = document.querySelectorAll('.choice-button');
        const answerContainer = document.getElementById('answer-container');
        const answerImage = document.getElementById('answer-image');
        const explanation = document.getElementById('explanation');
        const nextButton = document.getElementById('next-button');
        const skipSurveyButton = document.getElementById('skip-survey-button');
        const scoreElement = document.getElementById('score');
        const resultMessage = document.getElementById('result-message');
        const shareButton = document.getElementById('share-button');
        const retryButton = document.getElementById('retry-button');
        const feedbackModal = document.getElementById('feedback-modal');
        const feedbackModalContent = document.getElementById('feedback-modal-content');

        // クイズデータ (5問に減らす)
        const quizData = [
            { questionImage: "./q1.jpg", choices: ["飯田町燈籠山祭り", "宝立七夕キリコ祭り"], correctAnswer: 0, answerImage: "./q1answer.jpg", explanation: "正解は「飯田町燈籠山祭り」！高さ約16mにもなる巨大な燈籠山（とろやま）が街を練り歩く、迫力満点のお祭りです。" },
            { questionImage: "./q2.jpg", choices: ["禄剛崎（ろっこうさき）", "珠洲岬（すずみさき）"], correctAnswer: 0, answerImage: "./q2answer.jpg", explanation: "正解は「禄剛崎」。ここは朝日と夕日が同じ場所で見られる珍しい岬で、かつてはのろしを上げて航海の安全を見守った場所であり、多くの観光客が訪れています。" },
            { questionImage: "./q3.jpg", choices: ["流下式塩田", "揚げ浜式塩田"], correctAnswer: 1, answerImage: "./q3answer.jpg", explanation: "正解は「揚げ浜式塩田」。江戸時代に加賀藩主が自給自足のために奨励し、現在まで受け継がれている伝統的な製塩方法で、「重要無形民俗文化財」に指定されています。" },
            { questionImage: "./q4.jpg", choices: ["怪獣島", "見附島"], correctAnswer: 1, answerImage: "./q4answer.jpg", explanation: "正解は「見附島」。震災によって形が一部崩れてしまいましたが、ぜひ今の見附島を観にいらしてください。" },
            { questionImage: "./q5.jpg", choices: ["奥能登国際芸術祭", "大地の芸術祭"], correctAnswer: 0, answerImage: "./q5answer.jpg", explanation: "奥能登国際芸術祭は、珠洲の自然や生活文化を舞台にしたアートイベント。一部の作品は常設展示として残されており、今でも現地で鑑賞することができます。" }
        ];

        let currentQuestionIndex = 0;
        let score = 0;

        function displayQuiz() {
            const currentQuiz = quizData[currentQuestionIndex];
            questionNumber.textContent = currentQuestionIndex + 1;
            questionImage.src = currentQuiz.questionImage;
            
            choiceButtons.forEach((button, index) => {
                button.textContent = currentQuiz.choices[index];
                button.disabled = false;
                button.classList.remove('opacity-50', 'bg-green-500', 'bg-red-500');
            });

            answerContainer.classList.add('hidden');
            quizPage.classList.add('fade-in');
            quizPage.addEventListener('animationend', () => quizPage.classList.remove('fade-in'), { once: true });
        }

        function checkAnswer(selectedChoice) {
            choiceButtons.forEach(button => button.disabled = true);

            const currentQuiz = quizData[currentQuestionIndex];
            const isCorrect = selectedChoice === currentQuiz.correctAnswer;

            if (isCorrect) score++;

            // フィードバックモーダル表示
            feedbackModalContent.textContent = isCorrect ? "正解！" : "はずれ！";
            const gradient = isCorrect 
                ? 'linear-gradient(to right, #fde047, #f97316)' // 黄色〜オレンジ
                : 'linear-gradient(to right, #7dd3fc, #3b82f6)'; // 水色〜青
            feedbackModalContent.style.backgroundImage = gradient;
            feedbackModalContent.classList.add('gradient-text');

            feedbackModal.classList.remove('hidden');
            feedbackModalContent.classList.add('animate-bounce-in');

            // 選択肢の見た目を変更
            choiceButtons.forEach((button, index) => {
                if (index === currentQuiz.correctAnswer) {
                     button.style.backgroundImage = 'linear-gradient(to right, #22c55e, #16a34a)'; // 正解は緑
                } else if(index === selectedChoice){
                     button.style.backgroundImage = 'linear-gradient(to right, #ef4444, #dc2626)'; // 不正解選択肢は赤
                } else {
                    button.classList.add('opacity-50');
                }
            });
            
            // 1.5秒後にモーダルを消して解説までスクロール
            setTimeout(() => {
                feedbackModal.classList.add('hidden');
                feedbackModalContent.classList.remove('animate-bounce-in');

                answerImage.src = currentQuiz.answerImage;
                explanation.textContent = currentQuiz.explanation;
                if (currentQuestionIndex === quizData.length - 1) {
                    nextButton.textContent = "結果を見る";
                }
                answerContainer.classList.remove('hidden');
                
                // 解説コンテナまでスムーズスクロール
                answerContainer.scrollIntoView({ behavior: 'smooth', block: 'center' });

            }, 1500);
        }

        function nextQuiz() {
            currentQuestionIndex++;
            if (currentQuestionIndex < quizData.length) {
                // ボタンのグラデーションを元に戻す
                choiceButtons.forEach((button, index) => {
                    button.style.backgroundImage = ''; // style属性をクリアしてクラスのスタイルを適用
                    button.classList.remove('opacity-50');
                });
                displayQuiz();
            } else {
                quizPage.classList.add('hidden');
                surveyPage.classList.remove('hidden');
                surveyPage.classList.add('fade-in');
            }
        }
        
        function showResult() {
            surveyPage.classList.add('hidden');
            resultPage.classList.remove('hidden');
            resultPage.classList.add('fade-in');

            scoreElement.textContent = score;
            let message = "";
            // 5問用に結果メッセージを調整
            if(score <= 2) message = "まだまだ珠洲ビギナー！また挑戦してみてね！";
            else if (score <= 4) message = "なかなかの珠洲通！次は現地で確かめてみよう！";
            else message = "完璧！あなたはもう珠洲マスターだ！";
            resultMessage.textContent = message;

            const shareText = `まるごと珠洲クイズで${score}問正解しました！あなたも挑戦しよう！ #珠洲市 #能登半島`;
            const shareUrl = "https://beeb-c4n.github.io/quiz/"; // TODO: アプリのURLに変更
            shareButton.href = `https://twitter.com/intent/tweet?text=${encodeURIComponent(shareText)}&url=${encodeURIComponent(shareUrl)}`;
        }
        
        function resetGame() {
            currentQuestionIndex = 0;
            score = 0;
            nextButton.textContent = "次の問題へ";
             choiceButtons.forEach((button, index) => {
                button.style.backgroundImage = '';
            });
            resultPage.classList.add('hidden');
            topPage.classList.remove('hidden');
            topPage.classList.add('fade-in');
        }

        startButton.addEventListener('click', () => {
            topPage.classList.add('hidden');
            quizPage.classList.remove('hidden');
            displayQuiz();
        });

        choiceButtons.forEach(button => {
            button.addEventListener('click', (e) => checkAnswer(parseInt(e.target.dataset.choice)));
        });

        nextButton.addEventListener('click', nextQuiz);
        skipSurveyButton.addEventListener('click', showResult);
        retryButton.addEventListener('click', resetGame);
        
    </script>
</body>
</html>

